!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e="undefined"!=typeof globalThis?globalThis:e||self).Logbun=t()}(this,(function(){"use strict";var e,t="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},n={},r={},i={},o={exports:{}},a={exports:{}};function s(){return e||(e=1,function(e,t){e.exports=function(){function e(e){return!isNaN(parseFloat(e))&&isFinite(e)}function t(e){return e.charAt(0).toUpperCase()+e.substring(1)}function n(e){return function(){return this[e]}}var r=["isConstructor","isEval","isNative","isToplevel"],i=["columnNumber","lineNumber"],o=["fileName","functionName","source"],a=["args"],s=["evalOrigin"],c=r.concat(i,o,a,s);function u(e){if(e)for(var n=0;n<c.length;n++)void 0!==e[c[n]]&&this["set"+t(c[n])](e[c[n]])}u.prototype={getArgs:function(){return this.args},setArgs:function(e){if("[object Array]"!==Object.prototype.toString.call(e))throw new TypeError("Args must be an Array");this.args=e},getEvalOrigin:function(){return this.evalOrigin},setEvalOrigin:function(e){if(e instanceof u)this.evalOrigin=e;else{if(!(e instanceof Object))throw new TypeError("Eval Origin must be an Object or StackFrame");this.evalOrigin=new u(e)}},toString:function(){var e=this.getFileName()||"",t=this.getLineNumber()||"",n=this.getColumnNumber()||"",r=this.getFunctionName()||"";return this.getIsEval()?e?"[eval] ("+e+":"+t+":"+n+")":"[eval]:"+t+":"+n:r?r+" ("+e+":"+t+":"+n+")":e+":"+t+":"+n}},u.fromString=function(e){var t=e.indexOf("("),n=e.lastIndexOf(")"),r=e.substring(0,t),i=e.substring(t+1,n).split(","),o=e.substring(n+1);if(0===o.indexOf("@"))var a=/@(.+?)(?::(\d+))?(?::(\d+))?$/.exec(o,""),s=a[1],c=a[2],l=a[3];return new u({functionName:r,args:i||void 0,fileName:s,lineNumber:c||void 0,columnNumber:l||void 0})};for(var l=0;l<r.length;l++)u.prototype["get"+t(r[l])]=n(r[l]),u.prototype["set"+t(r[l])]=function(e){return function(t){this[e]=Boolean(t)}}(r[l]);for(var f=0;f<i.length;f++)u.prototype["get"+t(i[f])]=n(i[f]),u.prototype["set"+t(i[f])]=function(t){return function(n){if(!e(n))throw new TypeError(t+" must be a Number");this[t]=Number(n)}}(i[f]);for(var p=0;p<o.length;p++)u.prototype["get"+t(o[p])]=n(o[p]),u.prototype["set"+t(o[p])]=function(e){return function(t){this[e]=String(t)}}(o[p]);return u}()}(a)),a.exports}!function(e,t){var n,r,i,o;e.exports=(n=s(),r=/(^|@)\S+:\d+/,i=/^\s*at .*(\S+:\d+|\(native\))/m,o=/^(eval@)?(\[native code])?$/,{parse:function(e){if(void 0!==e.stacktrace||void 0!==e["opera#sourceloc"])return this.parseOpera(e);if(e.stack&&e.stack.match(i))return this.parseV8OrIE(e);if(e.stack)return this.parseFFOrSafari(e);throw new Error("Cannot parse given Error object")},extractLocation:function(e){if(-1===e.indexOf(":"))return[e];var t=/(.+?)(?::(\d+))?(?::(\d+))?$/.exec(e.replace(/[()]/g,""));return[t[1],t[2]||void 0,t[3]||void 0]},parseV8OrIE:function(e){return e.stack.split("\n").filter((function(e){return!!e.match(i)}),this).map((function(e){e.indexOf("(eval ")>-1&&(e=e.replace(/eval code/g,"eval").replace(/(\(eval at [^()]*)|(,.*$)/g,""));var t=e.replace(/^\s+/,"").replace(/\(eval code/g,"(").replace(/^.*?\s+/,""),r=t.match(/ (\(.+\)$)/);t=r?t.replace(r[0],""):t;var i=this.extractLocation(r?r[1]:t),o=r&&t||void 0,a=["eval","<anonymous>"].indexOf(i[0])>-1?void 0:i[0];return new n({functionName:o,fileName:a,lineNumber:i[1],columnNumber:i[2],source:e})}),this)},parseFFOrSafari:function(e){return e.stack.split("\n").filter((function(e){return!e.match(o)}),this).map((function(e){if(e.indexOf(" > eval")>-1&&(e=e.replace(/ line (\d+)(?: > eval line \d+)* > eval:\d+:\d+/g,":$1")),-1===e.indexOf("@")&&-1===e.indexOf(":"))return new n({functionName:e});var t=/((.*".+"[^@]*)?[^@]*)(?:@)/,r=e.match(t),i=r&&r[1]?r[1]:void 0,o=this.extractLocation(e.replace(t,""));return new n({functionName:i,fileName:o[0],lineNumber:o[1],columnNumber:o[2],source:e})}),this)},parseOpera:function(e){return!e.stacktrace||e.message.indexOf("\n")>-1&&e.message.split("\n").length>e.stacktrace.split("\n").length?this.parseOpera9(e):e.stack?this.parseOpera11(e):this.parseOpera10(e)},parseOpera9:function(e){for(var t=/Line (\d+).*script (?:in )?(\S+)/i,r=e.message.split("\n"),i=[],o=2,a=r.length;o<a;o+=2){var s=t.exec(r[o]);s&&i.push(new n({fileName:s[2],lineNumber:s[1],source:r[o]}))}return i},parseOpera10:function(e){for(var t=/Line (\d+).*script (?:in )?(\S+)(?:: In function (\S+))?$/i,r=e.stacktrace.split("\n"),i=[],o=0,a=r.length;o<a;o+=2){var s=t.exec(r[o]);s&&i.push(new n({functionName:s[3]||void 0,fileName:s[2],lineNumber:s[1],source:r[o]}))}return i},parseOpera11:function(e){return e.stack.split("\n").filter((function(e){return!!e.match(r)&&!e.match(/^Error created at/)}),this).map((function(e){var t,r=e.split("@"),i=this.extractLocation(r.pop()),o=r.shift()||"",a=o.replace(/<anonymous function(: (\w+))?>/,"$2").replace(/\([^)]*\)/g,"")||void 0;o.match(/\(([^)]*)\)/)&&(t=o.replace(/^[^(]+\(([^)]*)\)$/,"$1"));var s=void 0===t||"[arguments not available]"===t?void 0:t.split(",");return new n({functionName:a,args:s,fileName:i[0],lineNumber:i[1],columnNumber:i[2],source:e})}),this)}})}(o);var c=o.exports,u={exports:{}};!function(e,t){var n;e.exports=(n=s(),{backtrace:function(e){var t=[],r=10;"object"==typeof e&&"number"==typeof e.maxStackSize&&(r=e.maxStackSize);for(var i=arguments.callee;i&&t.length<r&&i.arguments;){for(var o=new Array(i.arguments.length),a=0;a<o.length;++a)o[a]=i.arguments[a];/function(?:\s+([\w$]+))+\s*\(/.test(i.toString())?t.push(new n({functionName:RegExp.$1||void 0,args:o})):t.push(new n({args:o}));try{i=i.caller}catch(e){break}}return t}})}(u);var l=u.exports,f=t&&t.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(i,"__esModule",{value:!0}),i.createEvent=i.normalizeError=i.isStackError=i.isError=i.getErrorStacktrace=void 0;const p=f(c),d=f(l);function g(e){return m(e)?p.default.parse(e):d.default.backtrace({maxStackSize:10})}function h(e){switch(Object.prototype.toString.call(e)){case"[object Error]":case"[object Exception]":case"[object DOMException]":return!0;default:return e instanceof Error}}function m(e){if(!e)return!1;const{stack:t,stacktrace:n,"opera#sourceloc":r}=e,i=!!t||!!n||!!r,o="string"==typeof(t||n||r),a=t!==`${e.name}: ${e.message}`;return i&&o&&a}function v(e){let t=new Error(`Application received an unexpected ${null===e?"null":typeof e} type`);switch(t.name="Invalid Error",typeof e){case"string":case"number":case"boolean":t=new Error(String(e));break;case"object":null!==e&&(h(e)?t=e:"name"in e&&"message"in e&&"string"==typeof e.message&&(t=new Error(e.message),"string"==typeof e.name&&(t.name=e.name)))}return t}i.getErrorStacktrace=g,i.isError=h,i.isStackError=m,i.normalizeError=v,i.createEvent=function(e){const t=v(e),n=g(t);return{name:t.name,message:t.message,stacktrace:n}},Object.defineProperty(r,"__esModule",{value:!0}),r.Client=void 0;const b=i;r.Client=class{constructor(e){this.pluginsLoaded=!1,this.loadLogger=()=>{const e=e=>(...t)=>{if("debug"===e){if(!this.config.debug)return;e="log"}t.unshift("[Logbun]"),this.config.logger&&this.config.logger[e](...t)};return{log:e("log"),info:e("info"),debug:e("debug"),warn:e("warn"),error:e("error")}},this.loadPlugins=()=>{if(this.pluginsLoaded)return this.config.plugins;this.config.plugins.forEach((e=>e.load(this))),this.pluginsLoaded=!0},this.init=e=>(this.config=Object.assign(Object.assign({},this.config),e),e.apiKey||this.logger.info("Api key not provided, client will not send events."),this.loadPlugins(),this),this.setSDK=e=>{this.sdk=e},this.addMetadata=(e,t)=>{this.metadata=Object.assign(Object.assign({},this.metadata),{[e]:t})},this.notify=e=>{const t=(0,b.createEvent)(e);this.send(Object.assign(Object.assign({},t),{level:"info",handled:!0}))},this.send=e=>{if(!this.config.endpoint)return this.logger.error("No endpoint");if(!this.transport)return this.logger.warn("Transport disabled. Skipping");if(!this.config.apiKey)return this.logger.warn("Api key not provided, client will not send events.");const t=e.metadata||{},n=Object.assign({timestamp:Math.floor(Date.now()/1e3),level:"error",handled:!1,metadata:Object.assign(Object.assign({},this.metadata),t)},e);this.transport.send({endpoint:this.config.endpoint,headers:{"X-API-Key":this.config.apiKey}},n)},this.config=Object.assign({endpoint:"https://logbun.com/api",debug:!1,logger:console},e),this.logger=this.loadLogger(),this.transport=e.transport,this.metadata=e.metadata||{},this.sdk={name:"@logbun/core",url:"https://github.com/logbun/logbun-js/tree/master/packages/core",version:"1.0.0"}}};var y={};Object.defineProperty(y,"__esModule",{value:!0}),function(e){var n=t&&t.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,i)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),o=t&&t.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),a=t&&t.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&n(t,e,r);return o(t,e),t};Object.defineProperty(e,"__esModule",{value:!0}),e.Utils=e.Types=e.Client=void 0;var s=r;Object.defineProperty(e,"Client",{enumerable:!0,get:function(){return s.Client}}),e.Types=a(y),e.Utils=a(i)}(n);class O extends n.Client{constructor(e){super(e)}createEvent(...e){return n.Utils.createEvent(e)}}const w=new O({transport:new class{headers={};constructor(e={}){this.headers={"Content-Type":"application/json",...e}}send=async(e,t)=>{const n=e.headers||{},r={method:e.method||"POST",headers:{...this.headers,...n}};"POST"===r.method&&t&&(r.body="string"==typeof t?t:JSON.stringify(t));const i=await fetch(e.endpoint,r),o=await i.text();return Promise.resolve({status:i.status,body:o})}},plugins:[function(e=window){return{load(t){const r=e.onerror;e.onerror=function(e,i,o,a,s){if(0===o&&"string"==typeof e&&/Script error\.?/.test(e))return t.logger.warn("Ignoring cross-domain or eval script error.");let c;if(s)c=n.Utils.createEvent(s);else{const t=new Error;t.name="Error",t.message="string"==typeof e?e:'An HTML onerror="" handler failed to execute',t.stack=`at ${i}:${o}${a?`:${a}`:""}`,c=n.Utils.createEvent(t)}t.send(c),"function"==typeof r&&r.apply(this,arguments)}}}}(),function(e=window){return{load(t){const r=e.onunhandledrejection;e.onunhandledrejection=function(e){let i=e.reason;try{const t=e;t.detail&&t.detail.reason&&(i=t.detail.reason)}catch(e){}const o=n.Utils.createEvent(i);t.send(o),"function"==typeof r&&r.apply(this,arguments)}}}}()]});return w.setSDK({name:"@logbun/js",url:"https://github.com/logbun/logbun-js/tree/master/packages/core/packages/js",version:"1.0.0"}),w}));
//# sourceMappingURL=logbun.min.js.map
